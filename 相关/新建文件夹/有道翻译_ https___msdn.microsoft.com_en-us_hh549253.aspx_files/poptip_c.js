var timeout=300;var timer=null;var divTop=1;var divLeft=1;var centerLogoHeight=20;var centerLineHeight=15;var centerOrigHeight=50;var centerExpandHeight=20;var centerTransHeight=0;var centerWidth=1;var centerHeight=1;var centerTransTextareaHeight=1;var acrossLineHeight=23;var siloLineWidth=10;var starWidth=27;var starWidthHalf=parseInt(starWidth/2);var starWidth2_3=parseInt(starWidth*2/3);var topStarStart=20;var topStarEnd=1;var bottomStarStart=30;var bottomStarEnd=1;var poptipWidth=1;var poptipHeight=1;var centerLogoTextWidth=66;var centerLogoYoudaoWidth=77;var centerLogoCloseWidth=22;var centerLogoLegalWidth=centerLogoTextWidth+centerLogoYoudaoWidth+centerLogoCloseWidth;var centerWidthMax=Math.min($(window).width()-40,500);var centerWidthMin=centerLogoLegalWidth;var textareaHeightMax=100;var buttonDivHeight=25;var scrollTop;var focusDiv;var isPoptipHovered=false;var isFocusDivHovered=false;var focusDiv;var hoveredDiv=null;var isExpanded=false;var isPoptipOnTop=true;var isPoptipFromLeftToRight=true;var servletname="WebpageTranslate";var redirectlink;var origText;var translatedText;var emptystyleprefix="border:none transparent 0px!important;outline:none transparent 0px!important;padding:0!important;";var $jjj=jQuery.noConflict();function GetURLParameter(a){var d=window.location.search.substring(1);var c=d.split("&");for(var b=0;b<c.length;b++){var e=c[b].split("=");if(e[0]==a){return decodeURIComponent(e[1])}}return""}function getrlink(){if(!redirectlink){redirectlink=GetURLParameter("rurl");if(!redirectlink){redirectlink="http://fanyi.myyoudao.com/"}}return redirectlink}function changelink(a,c){var b=a.indexOf("#");if(b>=0){var d=a.substring(b);self.location.href=self.location.href+d}else{top.location=redirectlink+servletname+"?url="+encodeURIComponent(a)+"&type="+c+"&keyfrom=webfanyi.changelink"}}$jjj(document).ready(function(){getrlink();var D=$jjj.browser;var n=false;if(D.msie){n=true}var m=$jjj("body");var g=$jjj('<div id="youdao-poptip" class="youdao-common-empty"></div>');m.append(g);var x=$jjj('<table cellSpacing=0 cellPadding=0 border=0 class="youdao-empty-common" style="background:none!important;"><tbody><tr class="youdao-empty"><td class="youdao-empty" id="youdao-poptip-lefttop"></td><td class="youdao-empty" id="youdao-poptip-top"></td><td class="youdao-empty" id="youdao-poptip-righttop"></td></tr><tr class="youdao-empty"><td class="youdao-empty" id="youdao-poptip-left"></td><td class="youdao-empty" id="youdao-poptip-center"></td><td class="youdao-empty" id="youdao-poptip-right"></td></tr><tr class="youdao-empty"><td class="youdao-empty" id="youdao-poptip-leftbottom"></td><td class="youdao-empty" id="youdao-poptip-bottom"></td><td class="youdao-empty" id="youdao-poptip-rightbottom"></td></tr></tbody></table>');g.append(x);var v=$jjj('<div class="youdao-empty-common" id="youdao-poptip-top1"></div>');var t=$jjj('<div class="youdao-empty-common" id="youdao-poptip-top2"></div>');var s=$jjj('<div class="youdao-empty-common" id="youdao-poptip-top3"></div>');var d=$jjj('<div class="youdao-empty-common" id="youdao-poptip-bottom1"></div>');var c=$jjj('<div class="youdao-empty-common" id="youdao-poptip-bottom2"></div>');var b=$jjj('<div class="youdao-empty-common" id="youdao-poptip-bottom3"></div>');var q=$jjj('<div id="youdao-poptip-logo"></div>');var l=$jjj('<span id="youdao-poptip-logotext">原文：</span>');var p=$jjj('<span id="youdao-poptip-logoimg" />');var j=$jjj('<span id="youdao-poptip-closeimg" />');q.append(l);q.append(p);q.append(j);var B=$jjj('<div id="youdao-poptip-centerline" class="youdao-empty-common"><hr width="100%" size="1" noshade="true" style="color:#aaa8a8" /></div>');var o=$jjj('<div style="text-align:left!important;background:none!important;'+emptystyleprefix+'"><div id="centerOrig" style="color:black!important;text-align:left!important;background:none!important;'+emptystyleprefix+'"></div></div>');o.css({width:"100%",height:centerOrigHeight+"px"});o.children().addClass("youdao-poptip-origtext");var w=$jjj('<div class="youdao-empty-common" id="youdao-poptip-feedback" ></div>');var z=$jjj('<div class="youdao-empty-common" id="youdao-poptip-feedbackexpand"></div>');var u=$jjj('<img id="youdao-poptip-feedbackexpandimg" class="youdao-poptip-feedbackexpandimg"><span id="youdao-poptip-feedbackexpandtext">更好的翻译建议</span></img>');z.append(u);var i=$jjj('<div id="youdao-poptip-feedbacktrans" class="youdao-empty-common"></div>');var C=$jjj('<textarea id="centerTransTextarea" class="youdao-poptip-feedbacktext" ></textarea>');var f=$jjj('<div id="youdao-poptip-feedbackbuttondiv" class="youdao-empty-common"></div>');var e=$jjj('<button id="youdao-poptip-feedbackbutton">提交翻译建议</button>');f.append(e);i.append(C);i.append(f);w.append(z);w.append(i);var k=$jjj('<div id="youdao-poptip-thanks" class="youdao-empty-common"><span id="youdao-poptip-thankstext">感谢您为有道提供建议^_^</span></div>');x.find("td:eq(1)").append(v).end().find("td:eq(1)").append(t).end().find("td:eq(1)").append(s).end().find("td:eq(7)").append(d).end().find("td:eq(7)").append(c).end().find("td:eq(7)").append(b).end().find("td:eq(4)").append(q).end().find("td:eq(4)").append(B).end().find("td:eq(4)").append(o).end().find("td:eq(4)").append(w).end().find("td:eq(4)").append(k).end();var y=$jjj('<div style="position:absolute;left:0px;top:0px;display:none"><div></div></div>');y.children().addClass("youdao-poptip-origtext");m.append(y);var r=$jjj('<span style="position:absolute;left:0px;top:0px;overflow:hidden;display:none"></span>');m.append(r);g.mouseover(function(){isPoptipHovered=true;if(isExpanded){return}g.css({display:"block"})});g.mouseout(function(){isPoptipHovered=false;if(!isExpanded){timer=setTimeout(function(){if(!isPoptipHovered&&hoveredDiv){hoveredDiv.removeClass("youdao-text-hover");hoveredDiv=null}if(!isPoptipHovered&&!isFocusDivHovered){g.css({display:"none"})}},timeout)}});j.click(function(){isPoptipHovered=false;if(isExpanded){A()}g.css({display:"none"});if(hoveredDiv){hoveredDiv.removeClass("youdao-text-hover");hoveredDiv=null}});e.click(function(){$jjj.post("http://wp-trans.test.youdao.com/BetterSuggest",{src:(origText==null?"":encodeURIComponent(origText)),tgt:(translatedText==null?"":encodeURIComponent(translatedText)),ref:($jjj("#centerTransTextarea").val()==null?"":encodeURIComponent($jjj("#centerTransTextarea").val())),keyfrom:"webfanyi"},function(E){w.css({display:"none"});k.css({height:w.height()+"px",width:"100%",display:"block"});C.css({display:"none"});f.css({display:"none"});i.css({height:0+"px"});u.parent().children("#youdao-poptip-feedbackexpandimg").attr("class","youdao-poptip-feedbackexpandimg");isExpanded=false})});z.click(function(){if(isExpanded){A()}else{a()}});$jjj(".youdao-hiddenspan").parent().mouseover(function(){isFocusDivHovered=true;if(isExpanded){return}focusDiv=$jjj(this);clearTimeout(timer);timer=setTimeout(function(){h()},timeout)});$jjj(".youdao-hiddenspan").parent().mouseout(function(){isFocusDivHovered=false;clearTimeout(timer);timer=setTimeout(function(){if(!isPoptipHovered&&!isExpanded){g.css({display:"none"});if(hoveredDiv){hoveredDiv.removeClass("youdao-text-hover");hoveredDiv=null}}},timeout)});function h(){if(!isFocusDivHovered){return}if(hoveredDiv){hoveredDiv.removeClass("youdao-text-hover")}hoveredDiv=focusDiv;focusDiv.addClass("youdao-text-hover");w.css({display:"block"});k.css({display:"none"});origText=focusDiv.children().text();translatedText=focusDiv.contents()[1].nodeValue;y.css({width:"auto",height:"auto"});y.children().text(origText);var L=y.width();if(L>centerWidthMax){L=centerWidthMax}else{if(L<centerWidthMin){L=centerWidthMin}}y.css({width:L+"px"});var O=y.height();o.children().text(origText);centerWidth=L+20;centerOrigHeight=O+10;centerHeight=centerLogoHeight+centerLineHeight+centerOrigHeight+centerExpandHeight+centerTransHeight;topStarEnd=centerWidth-topStarStart-starWidth;bottomStarEnd=centerWidth-bottomStarStart-starWidth;poptipWidth=centerWidth+siloLineWidth*2;poptipHeight=centerHeight+acrossLineHeight*2;l.css({width:(centerWidth-centerLogoYoudaoWidth-centerLogoCloseWidth-6)+"px"});o.css({height:centerOrigHeight+"px"});C.text(translatedText);C.val(translatedText);C.css({width:centerWidth-10+"px"});if(O<textareaHeightMax){centerTransTextareaHeight=O}else{centerTransTextareaHeight=textareaHeightMax}x.css({width:poptipWidth+"px",height:poptipHeight+"px"});x.find("td:eq(1)").css({width:centerWidth+"px"}).end().find("td:eq(3)").css({height:centerHeight+"px"}).end();if(n){r.remove();r=focusDiv.clone();r.css("cssText","position:absolute;left:0px;top:0px;width:auto;height:auto;overflow:hidden;display:none");m.append(r)}else{r.css({"font-family":focusDiv.css("font-family"),"font-size":focusDiv.css("font-size"),"font-style":focusDiv.css("font-style")});r.css({"font-variant":focusDiv.css("font-variant"),"font-weight":focusDiv.css("font-weight")});r.css({"font-size-adjust":focusDiv.css("font-size-adjust"),"font-stretch":focusDiv.css("font-stretch")})}r.text(translatedText);var E=r.innerWidth();var F=parseInt(focusDiv.css("line-height").replace("px",""));var K=parseInt(focusDiv.css("font-size").replace("px",""));var M=focusDiv.offset();var J=focusDiv.width();var I=focusDiv.height();var G=focusDiv.parent();var P=parseInt((centerWidth-starWidth)/2);isPoptipOnTop=true;isPoptipFromLeftToRight=true;scrollTop=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;if($jjj(window).height()<poptipHeight){divTop=M.top-poptipHeight}if(M.top-scrollTop<poptipHeight){divTop=M.top+I;isPoptipOnTop=false}else{divTop=M.top-poptipHeight}if(J>E&&focusDiv.innerHeight()>=(F+K)){if(isPoptipOnTop){isPoptipFromLeftToRight=false;divLeft=G.offset().left+G.width()-poptipWidth;P=centerWidth-starWidth;if(divLeft<0){var H=P+divLeft+starWidthHalf;if(H<0){H=0}if(P-H>=centerWidth/2){isPoptipFromLeftToRight=true}P=H;divLeft=0}}else{divLeft=G.offset().left;P=0}}else{divLeft=M.left+parseInt(J/2-poptipWidth/2)+starWidthHalf;var N=m.width();if(document.documentElement.clientWidth){N=document.documentElement.clientWidth>m.width()?document.documentElement.clientWidth:m.width()}else{if(document.body.clientWidth){N=document.body.clientWidth>m.width()?document.body.clientWidth:m.width()}}if(divLeft<0){var H=P+divLeft+starWidthHalf;if(H<P){P=H}divLeft=0}else{if(divLeft>N-poptipWidth){isPoptipFromLeftToRight=false;var H=P+divLeft+poptipWidth-N-starWidthHalf-2*starWidthHalf;if(H>P){P=H}divLeft=N-poptipWidth}}if(P<0){P=0}else{if(P>centerWidth-starWidth){P=centerWidth-starWidth}}}if(isPoptipOnTop){divTop+=1;t.attr("class","youdao-empty-common youdao-poptip-top2-normal");if(isPoptipFromLeftToRight){c.attr("class","youdao-empty-common youdao-poptip-bottom2-left")}else{c.attr("class","youdao-empty-common youdao-poptip-bottom2-right")}}else{divTop-=1;c.attr("class","youdao-empty-common youdao-poptip-bottom2-normal");if(isPoptipFromLeftToRight){t.attr("class","youdao-empty-common youdao-poptip-top2-left")}else{t.attr("class","youdao-empty-common youdao-poptip-top2-right")}}d.css({width:P+"px"});b.css({width:(centerWidth-P-starWidth)+"px"});v.css({width:P+"px"});s.css({width:(centerWidth-P-starWidth)+"px"});if(/mobile/i.test(navigator.userAgent)){divLeft=Math.max(0,divLeft)}g.css({display:"block",left:divLeft+"px",top:divTop+"px",width:poptipWidth+"px",height:poptipHeight+"px"});if(isPoptipOnTop){divTop=M.top-g.outerHeight()+1;divTop-=12;g.css({top:divTop+"px"})}}function A(){var E=centerTransTextareaHeight+10+buttonDivHeight;isExpanded=false;u.parent().children("#youdao-poptip-feedbackexpandimg").attr("class","youdao-poptip-feedbackexpandimg");if(isPoptipOnTop){divTop+=E;g.css({top:divTop+"px"})}C.css({display:"none"});f.css({display:"none"});i.css({height:0+"px"});g.css({height:poptipHeight-E+"px"});x.css({height:poptipHeight-E+"px"});x.find("td:eq(3)").css({height:centerHeight-E+"px"}).end()}function a(){var E=centerTransTextareaHeight+10+buttonDivHeight;isExpanded=true;u.parent().children("#youdao-poptip-feedbackexpandimg").attr("class","youdao-poptip-feedbackhideimg");if(isPoptipOnTop){divTop-=E;if(divTop-scrollTop<0){divTop=focusDiv.offset().top+focusDiv.height()-1;c.attr("class","youdao-empty-common youdao-poptip-bottom2-normal");if(isPoptipFromLeftToRight){t.attr("class","youdao-empty-common youdao-poptip-top2-left")}else{t.attr("class","youdao-empty-common youdao-poptip-top2-right")}isPoptipOnTop=false}g.css({top:divTop+"px"})}i.css({height:E+"px"});C.css({height:centerTransTextareaHeight+"px",display:"block"});f.css({display:"block"});g.css({height:poptipHeight+E+"px"});x.css({height:poptipHeight+E+"px"});x.find("td:eq(3)").css({height:centerHeight+E+"px"}).end()}});